{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport api from '@/services/api';\nimport { jwtDecode } from 'jwt-decode';\nimport AppointmentForm from '@/components/AppointmentForm.vue';\nexport default {\n  components: {\n    AppointmentForm\n  },\n  data() {\n    return {\n      appointments: [],\n      userRole: 'paciente' // Come√ßa como paciente para evitar erros\n    };\n  },\n  created() {\n    this.fetchAppointments();\n  },\n  methods: {\n    doLogout() {\n      localStorage.removeItem('authToken');\n      this.$router.push('/login');\n    },\n    async fetchAppointments() {\n      try {\n        const response = await api.get('/appointments');\n        this.appointments = response.data;\n        if (this.appointments.length > 0) {\n          if (this.appointments[0].pacienteId && this.appointments[0].pacienteId.nome) {\n            this.userRole = 'secretario';\n          } else {\n            this.userRole = 'paciente';\n          }\n        }\n      } catch (error) {\n        console.error(\"Erro ao buscar agendamentos:\", error);\n        alert('Sua sess√£o expirou ou ocorreu um erro. Por favor, fa√ßa o login novamente.');\n        this.doLogout();\n      }\n    },\n    async deleteAppointment(id) {\n      if (confirm('Tem certeza que deseja excluir este agendamento?')) {\n        try {\n          await api.delete(`/appointments/${id}`);\n          alert('Agendamento exclu√≠do com sucesso!');\n          this.fetchAppointments();\n        } catch (error) {\n          alert('Erro ao excluir: ' + error.response.data.error);\n        }\n      }\n    }\n  }\n};","map":{"version":3,"names":["api","jwtDecode","AppointmentForm","components","data","appointments","userRole","created","fetchAppointments","methods","doLogout","localStorage","removeItem","$router","push","response","get","length","pacienteId","nome","error","console","alert","deleteAppointment","id","confirm","delete"],"sources":["C:\\Users\\rafae\\OneDrive\\Desktop\\clinica-inteligente\\frontend\\src\\views\\DashboardView.vue"],"sourcesContent":["<template>\r\n  <div class=\"dashboard-container\">\r\n    <header class=\"dashboard-header\">\r\n      <h1>Minha Cl√≠nica</h1>\r\n      <button @click=\"doLogout\">Sair</button>\r\n    </header>\r\n    <main class=\"dashboard-main\">\r\n      <h2 v-if=\"userRole === 'secretario'\">Painel Administrativo - Agendamentos</h2>\r\n      <h2 v-else>Meus Agendamentos</h2>\r\n      \r\n      <AppointmentForm @new-appointment=\"fetchAppointments\" />\r\n\r\n      <div class=\"appointments-list\">\r\n        <h3>Lista de Agendamentos</h3>\r\n        <ul v-if=\"appointments.length > 0\">\r\n          <li v-for=\"app in appointments\" :key=\"app._id\">\r\n            <div class=\"app-info\">\r\n              <strong v-if=\"userRole === 'secretario' && app.pacienteId\">Paciente: {{ app.pacienteId.nome }}<br></strong>\r\n              <strong>Data:</strong> {{ new Date(app.data).toLocaleString('pt-BR', { dateStyle: 'short', timeStyle: 'short' }) }} <br>\r\n              <strong>Descri√ß√£o:</strong> {{ app.descricao }} <br>\r\n              <strong>Previs√£o:</strong> üå°Ô∏è {{ app.previsaoDoTempo }}\r\n            </div>\r\n            <div class=\"app-actions\" v-if=\"userRole === 'secretario'\">\r\n              <router-link :to=\"{ name: 'editAppointment', params: { id: app._id } }\" class=\"action-btn edit-btn\">Editar</router-link>\r\n              <button @click=\"deleteAppointment(app._id)\" class=\"action-btn delete-btn\">Excluir</button>\r\n            </div>\r\n          </li>\r\n        </ul>\r\n        <p v-else>Nenhum agendamento encontrado.</p>\r\n      </div>\r\n    </main>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport api from '@/services/api';\r\nimport { jwtDecode } from 'jwt-decode';\r\nimport AppointmentForm from '@/components/AppointmentForm.vue';\r\n\r\nexport default {\r\n  components: { AppointmentForm },\r\n  data() {\r\n    return {\r\n      appointments: [],\r\n      userRole: 'paciente' // Come√ßa como paciente para evitar erros\r\n    };\r\n  },\r\n  created() {\r\n    this.fetchAppointments();\r\n  },\r\n  methods: {\r\n    doLogout() {\r\n      localStorage.removeItem('authToken');\r\n      this.$router.push('/login');\r\n    },\r\n    async fetchAppointments() {\r\n      try {\r\n        const response = await api.get('/appointments');\r\n        this.appointments = response.data;\r\n        \r\n        if (this.appointments.length > 0) {\r\n          if (this.appointments[0].pacienteId && this.appointments[0].pacienteId.nome) {\r\n            this.userRole = 'secretario';\r\n          } else {\r\n            this.userRole = 'paciente';\r\n          }\r\n        }\r\n      } catch (error) {\r\n        console.error(\"Erro ao buscar agendamentos:\", error);\r\n        alert('Sua sess√£o expirou ou ocorreu um erro. Por favor, fa√ßa o login novamente.');\r\n        this.doLogout();\r\n      }\r\n    },\r\n    async deleteAppointment(id) {\r\n      if (confirm('Tem certeza que deseja excluir este agendamento?')) {\r\n        try {\r\n          await api.delete(`/appointments/${id}`);\r\n          alert('Agendamento exclu√≠do com sucesso!');\r\n          this.fetchAppointments();\r\n        } catch (error) {\r\n          alert('Erro ao excluir: ' + error.response.data.error);\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n.dashboard-container { width: 100vw; }\r\n.dashboard-main { max-width: 800px; margin: 0 auto; padding: 100px 20px; box-sizing: border-box;}\r\n.appointments-list ul { list-style: none; padding: 0; }\r\n.appointments-list li { background: white; padding: 15px; border-radius: 8px; margin-bottom: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; }\r\n.app-info { flex-grow: 1; }\r\n.app-actions { display: flex; flex-direction: column; margin-left: 15px; }\r\n.action-btn { padding: 5px 10px; font-size: 0.8em; margin-top: 5px; border-radius: 4px; text-align: center; border: none; cursor: pointer; color: white; text-decoration: none; }\r\n.edit-btn { background-color: #f59e0b; }\r\n.delete-btn { background-color: #ef4444; }\r\n</style>"],"mappings":";AAmCA,OAAOA,GAAE,MAAO,gBAAgB;AAChC,SAASC,SAAQ,QAAS,YAAY;AACtC,OAAOC,eAAc,MAAO,kCAAkC;AAE9D,eAAe;EACbC,UAAU,EAAE;IAAED;EAAgB,CAAC;EAC/BE,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,YAAY,EAAE,EAAE;MAChBC,QAAQ,EAAE,UAAS,CAAE;IACvB,CAAC;EACH,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR,IAAI,CAACC,iBAAiB,CAAC,CAAC;EAC1B,CAAC;EACDC,OAAO,EAAE;IACPC,QAAQA,CAAA,EAAG;MACTC,YAAY,CAACC,UAAU,CAAC,WAAW,CAAC;MACpC,IAAI,CAACC,OAAO,CAACC,IAAI,CAAC,QAAQ,CAAC;IAC7B,CAAC;IACD,MAAMN,iBAAiBA,CAAA,EAAG;MACxB,IAAI;QACF,MAAMO,QAAO,GAAI,MAAMf,GAAG,CAACgB,GAAG,CAAC,eAAe,CAAC;QAC/C,IAAI,CAACX,YAAW,GAAIU,QAAQ,CAACX,IAAI;QAEjC,IAAI,IAAI,CAACC,YAAY,CAACY,MAAK,GAAI,CAAC,EAAE;UAChC,IAAI,IAAI,CAACZ,YAAY,CAAC,CAAC,CAAC,CAACa,UAAS,IAAK,IAAI,CAACb,YAAY,CAAC,CAAC,CAAC,CAACa,UAAU,CAACC,IAAI,EAAE;YAC3E,IAAI,CAACb,QAAO,GAAI,YAAY;UAC9B,OAAO;YACL,IAAI,CAACA,QAAO,GAAI,UAAU;UAC5B;QACF;MACF,EAAE,OAAOc,KAAK,EAAE;QACdC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK,CAAC;QACpDE,KAAK,CAAC,2EAA2E,CAAC;QAClF,IAAI,CAACZ,QAAQ,CAAC,CAAC;MACjB;IACF,CAAC;IACD,MAAMa,iBAAiBA,CAACC,EAAE,EAAE;MAC1B,IAAIC,OAAO,CAAC,kDAAkD,CAAC,EAAE;QAC/D,IAAI;UACF,MAAMzB,GAAG,CAAC0B,MAAM,CAAC,iBAAiBF,EAAE,EAAE,CAAC;UACvCF,KAAK,CAAC,mCAAmC,CAAC;UAC1C,IAAI,CAACd,iBAAiB,CAAC,CAAC;QAC1B,EAAE,OAAOY,KAAK,EAAE;UACdE,KAAK,CAAC,mBAAkB,GAAIF,KAAK,CAACL,QAAQ,CAACX,IAAI,CAACgB,KAAK,CAAC;QACxD;MACF;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}